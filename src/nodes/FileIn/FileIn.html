<!-- FileIn.html -->
<script type="text/html" data-template-name="FileIn">
    <!-- Name -->
    <div class="editor-form-row">
        <label for="node-input-name">Name</label>
        <input type="text" id="node-input-name" class="node-input-property" style="width: 100%" />
    </div>

    <!-- File Path Selector -->
    <div class="editor-form-row">
        <label for="node-input-file-path">File</label>
        <input type="file" id="node-input-file-path" style="width: 100%" />
    </div>
</script>

<script type="text/javascript">
registerNode({
    type: 'FileIn',
    service: 'server',
    appearance: {
        color: '#6AB5BC',
        icon: 'file-in-node.svg',
        category: 'File Operation',
        nodeStyle: 'rectangle',
        label: function () {
            return this.name || 'File In';
        }
    },
    io: {
        inputs: 1,
        outputs: 1
    },
    defaults: {
        name: { value: '' },
        filepath: { value: '', required: true }
    },
    hooks: {
        onEdit: function (el, config) {
            const node = this;
            if (node.filepath) {
                // Simulate file prefill (not possible directly due to browser security)
                console.warn('Prefilling file input is not supported for security reasons.');
            }
        },
        onSave: function (el, config) {
            const node = this;
            const fileInput = document.getElementById('node-input-file-path');
            if (fileInput.files.length > 0) {
                node.filepath = fileInput.files[0].name; // Store only file name or metadata
            } else {
                node.filepath = '';
            }
        }
    }
});
</script>
